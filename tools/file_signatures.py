import time
def check_file_header(file):

    print("\nChecking file header for known types...")
    time.sleep(1)
    #dictinary list of file extensions and its signatures
    magic_numbers = {
                 'png': bytes([0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A]),
                 'jpg': bytes([0xFF, 0xD8, 0xFF, 0xE0]),
                 'BMP': bytes([0x42, 0x4D]),
                 'GIF': bytes([0x47, 0x49, 0x46, 0x38, 0x37, 0x61]),
                 'doc': bytes([0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1]),
                 'xls': bytes([0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1]),
                 'ppt': bytes([0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1]),
                 'docx': bytes([0x50, 0x4B, 0x03, 0x04, 0x14, 0x00, 0x06, 0x00]),
                 'zip': bytes([0x50, 0x4B, 0x03, 0x04, 0x14, 0x00, 0x06, 0x00]),
                 'xlsx': bytes([0x50, 0x4B, 0x03, 0x04, 0x14, 0x00, 0x06, 0x00]),
                 'pptx': bytes([0x50, 0x4B, 0x03, 0x04, 0x14, 0x00, 0x06, 0x00]),
                 'pdf': bytes([0x25, 0x50, 0x44, 0x46]),
                 'dll': bytes([0x4D, 0x5A, 0x90, 0x00]),
                 'exe': bytes([0x4D, 0x5A]),
                 'ELF': bytes([0x7F, 0x45, 0x4C, 0x46]),
                 'Rar': bytes([0x52, 0x61, 0x72, 0x21, 0x1A, 0x07, 0x01, 0x00]),
                 'pcap': bytes([0xA1, 0xB2, 0x3C, 0x4D]),
                 'txt': bytes([0xEF, 0xBB, 0xBF]),
                 }
    file_type = list()
    #iterating through file signatures
    for i in magic_numbers:
        if file.startswith(magic_numbers[i]):
            file_type.append(i)

    if len(file_type) == 0:
        print("\n-> No header found. <-\n")

    else:
        print("File has match with: ", end=" ")
        for i in file_type:
            print(i, end=" ")
    print()


